{% extends 'basemodel.html' %}

{% block title_block %}
    ChIP Peak Annotation - HEMU
{% endblock %}

{% block header_block %}
    {% load static %}
    <div class="col-sm-2">
        <div style="margin-top: 10px; margin-left: -5px">
            <img src="{% static "AllPageStatic/HEMU_logo_crop.png" %}" class="img-responsive" alt="Responsive image" style="width: 72px; height: 104px">
        </div>
    </div>
    <div class="col-sm-10">
        <h2 style="margin-top: 20px; margin-left: -70px">ChIP-seq Peak Annotation Analysis</h2>
        <p style="color: #8e8e8e; margin-left: -65px">Analyze ChIP-seq data based on R::ChIPseeker regarding <br>representative Andropogoneae species.</p>
    </div>
{% endblock %}

{% block content_block %}
    <div class='container'><div class='row'><div class="col-md-12">
        <div class="panel panel-default"><!--Section 1-->
            <div class="panel-heading" style="text-align: center">ChIP peak annotation: Result</div>
            <div class="panel-body"><div class="text-center">
                <p><strong>Table 1: </strong>Detailed information regarding annotated ChIP peaks</p>
                <br>
                <a href="javascript:previewCSV('{% static 'Temp_R_epigenome/' %}{{ result_folder_name }}/Peakannotation.csv')" class="btn btn-info" style="height: 45px">
                    <span class="glyphicon glyphicon-file"></span>
                    Preview table online
                </a>
                <a href="{% static 'Temp_R_epigenome/' %}{{ result_folder_name }}/Peakannotation.csv" class="btn btn-default">
                    <span class="glyphicon glyphicon-download"></span>
                    Download full table (.csv)
                </a>
                <br><br>
                <p><strong>Figure 1: </strong>Peak distribution heatmap (TSS region)</p>
                <img src="{% static 'Temp_R_epigenome/' %}{{ result_folder_name }}/Alignplot.png"
                                class="img-thumbnail" alt="Cinque Terre" width="400px" height="560px">
                <br><br>
                <p><strong>Figure 2 <strong style="color: darkred;">[interactive]</strong>: </strong>Peak distribution density map (TSS region)</p>
                <iframe src="{% static 'Temp_R_epigenome/' %}{{ result_folder_name }}/Bindplot.html"
                                width="900px" height= "500px" name="topFrame" frameborder="0"></iframe>
                <br>
                <a href="{% static 'Temp_R_epigenome/' %}{{ result_folder_name }}/Bindplot.png" class="btn btn-default">
                    <span class="glyphicon glyphicon-download"></span>
                    Download static image (.png)
                </a>
                <br><br>
                <p><strong>Figure 3: </strong>Proportion of peaks within certain genomic regions (pie plot)</p>
                <img src="{% static 'Temp_R_epigenome/' %}{{ result_folder_name }}/Region_pieplot.png"
                                class="img-thumbnail" alt="Cinque Terre" width="600px" height="360px">
                <br><br>
                <p><strong>Figure 4: </strong>Proportion of peaks within certain genomic regions (venn plot)</p>
                <img src="{% static 'Temp_R_epigenome/' %}{{ result_folder_name }}/Region_vennpieplot.png"
                                class="img-thumbnail" alt="Cinque Terre" width="600px" height="360px">
                <br><br>
                <p><strong>Figure 5 <strong style="color: darkred;">[interactive]</strong>: </strong>Distribution of TF binding loci relative to TSS (predicted)</p>
                <iframe src="{% static 'Temp_R_epigenome/' %}{{ result_folder_name }}/DistToTSS.html"
                                width="900px" height= "500px" name="topFrame" frameborder="0"></iframe>
                <br>
                <a href="{% static 'Temp_R_epigenome/' %}{{ result_folder_name }}/DistToTSS.png" class="btn btn-default">
                    <span class="glyphicon glyphicon-download"></span>
                    Download static image (.png)
                </a>
            </div></div>
        </div>
    </div></div></div>
{% endblock %}

{% block footer_script_block %}
    <script>
    // Preview CSV table
    function previewCSV(path_to_CSV){
        Papa.parse(path_to_CSV, {
            download: true,
            complete: function(results) {
                Heiho(results.data);
            }
        });
    }
    </script>
{% endblock %}